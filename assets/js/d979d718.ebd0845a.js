"use strict";(self.webpackChunkjustwe7_books=self.webpackChunkjustwe7_books||[]).push([[7646],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>m});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),u=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=u(e.components);return a.createElement(l.Provider,{value:n},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},f=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(t),f=r,m=d["".concat(l,".").concat(f)]||d[f]||p[f]||i;return t?a.createElement(m,o(o({ref:n},c),{},{components:t})):a.createElement(m,o({ref:n},c))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=f;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[d]="string"==typeof e?e:r,o[1]=s;for(var u=2;u<i;u++)o[u]=t[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}f.displayName="MDXCreateElement"},9098:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>u});var a=t(7462),r=(t(7294),t(3905));const i={},o=void 0,s={unversionedId:"\u7f16\u7a0b\u5907\u5fd8\u5f55/js-utils\u901f\u67e5",id:"\u7f16\u7a0b\u5907\u5fd8\u5f55/js-utils\u901f\u67e5",title:"js-utils\u901f\u67e5",description:"\u83b7\u53d6css\u6837\u5f0f",source:"@site/docs/\u7f16\u7a0b\u5907\u5fd8\u5f55/js-utils\u901f\u67e5.md",sourceDirName:"\u7f16\u7a0b\u5907\u5fd8\u5f55",slug:"/\u7f16\u7a0b\u5907\u5fd8\u5f55/js-utils\u901f\u67e5",permalink:"/docs/\u7f16\u7a0b\u5907\u5fd8\u5f55/js-utils\u901f\u67e5",draft:!1,editUrl:"https://github.com/justwe7/justwe7.github.io/blob/feature/docs/\u7f16\u7a0b\u5907\u5fd8\u5f55/js-utils\u901f\u67e5.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"git\u5982\u4f55\u4fdd\u6301commit\u4fe1\u606f\u6574\u6d01",permalink:"/docs/\u7f16\u7a0b\u5907\u5fd8\u5f55/git\u5982\u4f55\u4fdd\u6301commit\u4fe1\u606f\u6574\u6d01"},next:{title:"nginx\u63a7\u5236",permalink:"/docs/\u7f16\u7a0b\u5907\u5fd8\u5f55/nginx\u63a7\u5236"}},l={},u=[{value:"\u83b7\u53d6css\u6837\u5f0f",id:"\u83b7\u53d6css\u6837\u5f0f",level:2},{value:"\u7f13\u51b2\u51fd\u6570",id:"\u7f13\u51b2\u51fd\u6570",level:2},{value:"\u6296\u52a8\u51fd\u6570",id:"\u6296\u52a8\u51fd\u6570",level:2},{value:"\u83b7\u53d6\u4e00\u4e9b\u4e0a\u4e0b\u5de6\u53f3\u8282\u70b9",id:"\u83b7\u53d6\u4e00\u4e9b\u4e0a\u4e0b\u5de6\u53f3\u8282\u70b9",level:2},{value:"\u83b7\u53d6class",id:"\u83b7\u53d6class",level:2},{value:"\u6dfb\u52a0class",id:"\u6dfb\u52a0class",level:2},{value:"\u5220\u9664class",id:"\u5220\u9664class",level:2},{value:"\u83b7\u53d6dom\u4f4d\u7f6e",id:"\u83b7\u53d6dom\u4f4d\u7f6e",level:2},{value:"\u5224\u65adIE",id:"\u5224\u65adie",level:2},{value:"\u53d6\u6d88\u5192\u6ce1",id:"\u53d6\u6d88\u5192\u6ce1",level:2},{value:"\u5220\u6570\u7ec4\u7684\u67d0\u4e2a",id:"\u5220\u6570\u7ec4\u7684\u67d0\u4e2a",level:2},{value:"\u62d6\u62fd\u51fd\u6570",id:"\u62d6\u62fd\u51fd\u6570",level:2},{value:"\u78b0\u649e\u51fd\u6570",id:"\u78b0\u649e\u51fd\u6570",level:2},{value:"\u5224\u65ad\u8bbe\u5907ua",id:"\u5224\u65ad\u8bbe\u5907ua",level:2},{value:"url\u89e3\u6790",id:"url\u89e3\u6790",level:2},{value:"\u65e5\u671f\u683c\u5f0f\u5316",id:"\u65e5\u671f\u683c\u5f0f\u5316",level:2},{value:"\u4e0a\u4f20\u56fe\u7247",id:"\u4e0a\u4f20\u56fe\u7247",level:2},{value:"\u9632\u6296",id:"\u9632\u6296",level:2},{value:"\u4ece\u65e5\u671f\u4e2d\u83b7\u53d6\u65f6\u95f4",id:"\u4ece\u65e5\u671f\u4e2d\u83b7\u53d6\u65f6\u95f4",level:2},{value:"\u7ed9url\u6dfb\u52a0\u67e5\u8be2\u5b57\u7b26\u4e32",id:"\u7ed9url\u6dfb\u52a0\u67e5\u8be2\u5b57\u7b26\u4e32",level:2},{value:"\u5c0f\u7a0b\u5e8f\u6279\u91cf\u4e0a\u4f20\u56fe\u7247",id:"\u5c0f\u7a0b\u5e8f\u6279\u91cf\u4e0a\u4f20\u56fe\u7247",level:2},{value:"\u5ba2\u6237\u7aef\u83b7\u53d6\u5b9a\u4f4d",id:"\u5ba2\u6237\u7aef\u83b7\u53d6\u5b9a\u4f4d",level:2}],c={toc:u};function d(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"\u83b7\u53d6css\u6837\u5f0f"},"\u83b7\u53d6css\u6837\u5f0f"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function getStyle(obj,attr){\n    return obj.currentStyle?obj.currentStyle[attr]:getComputedStyle(obj)[attr];\n}\n")),(0,r.kt)("h2",{id:"\u7f13\u51b2\u51fd\u6570"},"\u7f13\u51b2\u51fd\u6570"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"var num=0 \n function starMove(obj,attr,target){\n    timer = setInterval(function(){\n        num++;\n        var cur = parseInt(getStyle(obj,attr));\n        var speed = (target - cur)/6;   \n    if(speed > 0){\n        speed = Math.ceil(speed);\n    }else{\n        speed = Math.floor(speed);\n    }\n    if(target == cur){\n        clearInterval(timer);\n    }\n    obj.style[attr] = cur + speed +'px';\n    },30);  \n    }\n")),(0,r.kt)("h2",{id:"\u6296\u52a8\u51fd\u6570"},"\u6296\u52a8\u51fd\u6570"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function shake (obj,attr,n,callback) {\n    if(obj.onOff){\n        return;\n    }\n    obj.onOff = true;\n    var arr = [];\n    var num = 0;\n    for(var i=n;i>0;i-=2){\n        arr.push(i,-i);\n    }\n    arr.push(0);\n    var oStyle = parseInt(getStyle(obj,attr));\n    var timer = setInterval(function(){\n        obj.style[attr] = oStyle+arr[num]+'px';\n        num++;\n        if(num == arr.length){\n            clearInterval(timer);\n            num = 0;\n            /*obj.onOff = false;\n            callback && callback(obj);*/\n            if (callback && typeof callback == 'function') {\n            callback(obj);\n            } else{\n            obj.onOff = false;\n            };\n        }\n        },30);\n    }\n")),(0,r.kt)("h2",{id:"\u83b7\u53d6\u4e00\u4e9b\u4e0a\u4e0b\u5de6\u53f3\u8282\u70b9"},"\u83b7\u53d6\u4e00\u4e9b\u4e0a\u4e0b\u5de6\u53f3\u8282\u70b9"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function getNext(obj){//\u4e0b\u4e00\u4e2a\n    if(!obj || !obj.nextSibling){\n        return null;\n    }\n    return obj.nextSibling.nodeType==1?obj.nextSibling:getNext(obj.nextSibling);\n}\nfunction getPrev(obj){//\u4e0a\u4e00\u4e2a\n    if(!obj || !obj.previousSibling){\n        return null;\n    }\n    return obj.previousSibling.nodeType==1?obj.previousSibling:getPrev(obj.previousSibling);\n}\nfunction getFirst(obj){//\u7b2c\u4e00\u4e2a\n    if(!obj || !obj.firstChild){\n        return null;\n    }\n    return obj.firstChild.nodeType == 1?obj.firstChild:getNext(obj.firstChild);\n}\nfunction getLast(obj){//\u5012\u4e00\u4e2a\n    if(!obj || !obj.lastChild){\n        return null;\n    }\n    return obj.lastChild.nodeType == 1?obj.lastChild:getPrev(obj.lastChild);\n}\n")),(0,r.kt)("h2",{id:"\u83b7\u53d6class"},"\u83b7\u53d6class"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function getByClass(sClass,obj){\n    obj = obj || document;\n    var aEle = obj.getElementsByTagName('*');\n    var arr = [];\n    for(var i=0;i<aEle.length;i++){\n        var aClass = aEle[i].className.split(' ');\n        for(var j=0;j<aClass.length;j++){\n            if(aClass[j] == sClass){\n                arr.push(aEle[i]);\n            }\n        }\n    }\n    return arr;\n    }\n")),(0,r.kt)("h2",{id:"\u6dfb\u52a0class"},"\u6dfb\u52a0class"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function addClass(obj,sClass){\n    if(!obj.className){\n        obj.className = sClass;\n        return;\n    }\n    //aClass:\u5c06\u8fd9\u4e2a\u5143\u7d20\u8eab\u4e0a\u7684class\u627e\u5230\u5e76\u4e14\u7528' '\u5207\u5f00\u3002\n    var aClass = obj.className.split(' ');\n    //\u5faa\u73af\u8fd9\u4e2a\u5143\u7d20\u8eab\u4e0a\u7684\u6240\u6709class\uff0c\u5982\u679c\u4f20\u5165\u7684class\u6b63\u597d\u7b49\u4e8e\u5143\u7d20\u81ea\u8eab\u7684class\uff0c\u90a3\u4e48\u5c31\u4e0d\u7528\u6dfb\u52a0\u4e86\u3002\n    for(var i=0;i<aClass.length;i++){\n        if(aClass[i] == sClass){\n            return;\n        }\n    }\n    obj.className += ' ' + sClass;\n}\n")),(0,r.kt)("h2",{id:"\u5220\u9664class"},"\u5220\u9664class"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function removeClass(obj,sClass){\n    if(!sClass){\n        obj.className = '';\n        return;\n    }\n    if(!obj.className){\n        return;\n    }\n    var aClass = obj.className.split(' ');\n    for(var i=0;i<aClass.length;i++){\n        if(aClass[i] == sClass){\n            aClass.splice(i,1);\n        }\n    }\n    obj.className = aClass.join(' ');\n}\n")),(0,r.kt)("h2",{id:"\u83b7\u53d6dom\u4f4d\u7f6e"},"\u83b7\u53d6dom\u4f4d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function getPos(obj){\n    var iLeft = 0,iTop = 0,Bl=0,Bt=0;\n    while(obj){\n        iLeft+=obj.offsetLeft + Bl;\n        iTop+=obj.offsetTop + Bt;\n        obj = obj.offsetParent;\n        if(obj){\n            Bl = parseInt(getStyle(obj,'borderLeftWidth'));\n            Bl = isNaN(Bl)?0:Bl;\n            Bt = parseInt(getStyle(obj,'borderTopWidth'));\n            Bt = isNaN(Bt)?0:Bt;\n        }\n    }\n    return {\n        l:iLeft,\n        t:iTop\n    }\n}\nfunction getStyle(obj,attr){\n    return obj.currentStyle?obj.currentStyle[attr]:getComputedStyle(obj)[attr];\n}\n")),(0,r.kt)("h2",{id:"\u5224\u65adie"},"\u5224\u65adIE"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function getIE(v){\n    var str = window.navigator.userAgent;\n    if(str.toLowerCase().indexOf(v)!=-1){\n        return true;\n    }else{\n        return false;\n    }\n}\n")),(0,r.kt)("h2",{id:"\u53d6\u6d88\u5192\u6ce1"},"\u53d6\u6d88\u5192\u6ce1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function stopBubble(e) {\n//\u5982\u679c\u63d0\u4f9b\u4e86\u4e8b\u4ef6\u5bf9\u8c61\uff0c\u5219\u8fd9\u662f\u4e00\u4e2a\u975eIE\u6d4f\u89c8\u5668\nif ( e && e.stopPropagation )\n    //\u56e0\u6b64\u5b83\u652f\u6301W3C\u7684stopPropagation()\u65b9\u6cd5\n    e.stopPropagation();\nelse\n    //\u5426\u5219\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528IE\u7684\u65b9\u5f0f\u6765\u53d6\u6d88\u4e8b\u4ef6\u5192\u6ce1\n    window.event.cancelBubble = true;\n}\n")),(0,r.kt)("h2",{id:"\u5220\u6570\u7ec4\u7684\u67d0\u4e2a"},"\u5220\u6570\u7ec4\u7684\u67d0\u4e2a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function cutArr(arr,val,num){\n        num = num || 0;\n        for(var i=num;arr.indexOf(val,i)!=-1;){\n            i = arr.indexOf(val,i)+1;\n            arr.splice(i-1,1)\n        }\n        return arr;\n    }\n")),(0,r.kt)("h2",{id:"\u62d6\u62fd\u51fd\u6570"},"\u62d6\u62fd\u51fd\u6570"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function drag(obj) {\n    obj.onmousedown = function(ev) {\n        var ev = ev || event;\n        var disX = ev.clientX - this.offsetLeft;\n        var disY = ev.clientY - this.offsetTop;\n        if ( obj.setCapture ) {\n            obj.setCapture();\n        }\n        document.onmousemove = function(ev) {\n            var ev = ev || event;\n            obj.style.left = ev.clientX - disX + 'px';\n            obj.style.top = ev.clientY - disY + 'px';\n        }\n        document.onmouseup = function() {\n            document.onmousemove = document.onmouseup = null;\n            //\u91ca\u653e\u5168\u5c40\u6355\u83b7 releaseCapture();\n            if ( obj.releaseCapture ) {\n                obj.releaseCapture();\n            }\n        }\n        return false;\n    }\n}\n")),(0,r.kt)("h2",{id:"\u78b0\u649e\u51fd\u6570"},"\u78b0\u649e\u51fd\u6570"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function drag(obj,obj2,boFn,noBoFn){\n    obj.onmousedown = function(ev){\n        var e = ev || event;\n        var disX = e.clientX - obj.offsetLeft;\n        var disY = e.clientY - obj.offsetTop;\n        if(obj.setCapture){\n            obj.setCapture();\n        }\n        document.onmousemove = function(ev){\n            var oEvent = ev || event;\n            if(boom(obj,obj2)){\n                boFn && boFn();\n            }else{\n                noBoFn && noBoFn();\n            }\n            obj.style.left = oEvent.clientX - disX + 'px';\n            obj.style.top = oEvent.clientY - disY + 'px';\n        }\n        document.onmouseup = function(){\n            document.onmousemove = null;\n            document.onmouseup = null;\n            if(obj.releaseCapture){\n                obj.releaseCapture();\n            }\n        }\n        return false;\n    }\n}\nfunction boom(obj,obj2){\n    //\u8981\u62d6\u62fd\u5143\u7d20\u7684\u4e0a\u4e0b\u5de6\u53f3\u7684\u8fb9\u3002\n    var l1 = obj.offsetLeft;\n    var r1 = l1 + obj.offsetWidth;\n    var t1 = obj.offsetTop;\n    var b1 = t1 + obj.offsetHeight;\n    //\u8981\u88ab\u78b0\u649e\u7684\u4e0a\u4e0b\u5de6\u53f3\u8fb9\u3002\n    var l2 = obj2.offsetLeft;\n    var r2 = l2 + obj2.offsetWidth;\n    var t2 = obj2.offsetTop;\n    var b2 = t2 + obj2.offsetHeight;\n    if(r1 < l2 || b1 < t2 || r2 < l1 || t1 > b2){ //\u6ca1\u78b0\u5230\n        return false;\n    }else{\n        return true;\n    }\n}\n")),(0,r.kt)("h2",{id:"\u5224\u65ad\u8bbe\u5907ua"},"\u5224\u65ad\u8bbe\u5907ua"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function parseUA() {\n    var u = navigator.userAgent;\n    var u2 = navigator.userAgent.toLowerCase();\n    return { //\u79fb\u52a8\u7ec8\u7aef\u6d4f\u89c8\u5668\u7248\u672c\u4fe1\u606f\n        trident: u.indexOf('Trident') > -1, //IE\u5185\u6838\n        presto: u.indexOf('Presto') > -1, //opera\u5185\u6838\n        webKit: u.indexOf('AppleWebKit') > -1, //\u82f9\u679c\u3001\u8c37\u6b4c\u5185\u6838\n        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //\u706b\u72d0\u5185\u6838\n        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //\u662f\u5426\u4e3a\u79fb\u52a8\u7ec8\u7aef\n        ios: !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios\u7ec8\u7aef\n        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android\u7ec8\u7aef\u6216uc\u6d4f\u89c8\u5668\n        iPhone: u.indexOf('iPhone') > -1, //\u662f\u5426\u4e3aiPhone\u6216\u8005QQHD\u6d4f\u89c8\u5668\n        iPad: u.indexOf('iPad') > -1, //\u662f\u5426iPad\n        webApp: u.indexOf('Safari') == -1, //\u662f\u5426web\u5e94\u8be5\u7a0b\u5e8f\uff0c\u6ca1\u6709\u5934\u90e8\u4e0e\u5e95\u90e8\n        iosv: u.substr(u.indexOf('iPhone OS') + 9, 3),\n        weixin: u2.match(/MicroMessenger/i) == \"micromessenger\",\n        ali: u.indexOf('AliApp') > -1,\n    };\n}\nvar ua = parseUA();\n\nif (!ua.mobile) {\n    location.href = './pc.html';\n}\n\n/* dom\u5199\u5165 */\nfunction usragent() {\n    var Sys = {};\n    var ua = navigator.userAgent.toLowerCase();\n    var s;\n    (s = ua.match(/rv:([\\d.]+)\\) like gecko/)) ? Sys.ie = s[1] :\n        (s = ua.match(/msie ([\\d.]+)/)) ? Sys.ie = s[1] :\n            (s = ua.match(/firefox\\/([\\d.]+)/)) ? Sys.firefox = s[1] :\n                (s = ua.match(/chrome\\/([\\d.]+)/)) ? Sys.chrome = s[1] :\n                    (s = ua.match(/opera.([\\d.]+)/)) ? Sys.opera = s[1] :\n                        (s = ua.match(/version\\/([\\d.]+).*safari/)) ? Sys.safari = s[1] : 0;\n\n    if (Sys.ie) document.write('IE: ' + Sys.ie);\n    if (Sys.firefox) document.write('Firefox: ' + Sys.firefox);\n    if (Sys.chrome) document.write('Chrome: ' + Sys.chrome);\n    if (Sys.opera) document.write('Opera: ' + Sys.opera);\n    if (Sys.safari) document.write('Safari: ' + Sys.safari);\n}\n")),(0,r.kt)("h2",{id:"url\u89e3\u6790"},"url\u89e3\u6790"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function urlParse() {\n  var url = window.location.search;\n  var _obj = {};\n  var reg = /[?&][^?&]+=[^?&]+/g; //\u5339\u914d ?\u6216\u8005&  +  \u975e?\u6216\u8005&\u4e00\u4e2a\u6216\u591a\u4e2a +  =  +  \u975e?\u6216\u8005&\u4e00\u4e2a\u6216\u591a\u4e2a + \u5168\u5c40\n  var arr = url.match(reg);  //\u5207\u5272\u4e3a\u4e24\u4e2a\u6570\u7ec4  ['?id=12345', '&a=b']\n  if (arr) {\n    arr.forEach(function(item) {\n      var tempArr = item.substring(1).split('=');\n      var key = decodeURIComponent(tempArr[0]);\n      var val = decodeURIComponent(tempArr[1]);\n      _obj[key] = val;\n    });\n  }\n  return _obj;\n}\n")),(0,r.kt)("h2",{id:"\u65e5\u671f\u683c\u5f0f\u5316"},"\u65e5\u671f\u683c\u5f0f\u5316"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function formatDate(date, fmt) {\n  fmt = fmt || "YYYY-MM-DD HH:mm:ss";\n  if (!date) {\n    return "";\n  }\n  if (typeof date === "string") {\n    date = isNaN(Number(date)) ? new Date(date.replace(/-/g, \'/\')) : new Date(+date);\n  }\n  if (typeof date === "number") {\n    date = new Date(date);\n  }\n  var o = {\n    "M+": date.getMonth() + 1,\n    "D+": date.getDate(),\n    "h+": date.getHours() % 12 === 0 ? 12 : date.getHours() % 12,\n    "H+": date.getHours(),\n    "m+": date.getMinutes(),\n    "s+": date.getSeconds(),\n    "q+": Math.floor((date.getMonth() + 3) / 3),\n    "S": date.getMilliseconds()\n  };\n  var week = {\n    "0": "\\u65e5",\n    "1": "\\u4e00",\n    "2": "\\u4e8c",\n    "3": "\\u4e09",\n    "4": "\\u56db",\n    "5": "\\u4e94",\n    "6": "\\u516d"\n  };\n  if (/(Y+)/.test(fmt)) {\n    fmt = fmt.replace(\n      RegExp.$1,\n      (date.getFullYear() + "").substr(4 - RegExp.$1.length)\n    );\n  }\n  if (/(E+)/.test(fmt)) {\n    fmt = fmt.replace(\n      RegExp.$1,\n      (RegExp.$1.length > 1\n        ? RegExp.$1.length > 2\n          ? "\\u661f\\u671f"\n          : "\\u5468"\n        : "") + week[date.getDay() + ""]\n    );\n  }\n  for (var k in o) {\n    if (new RegExp("(" + k + ")").test(fmt)) {\n      fmt = fmt.replace(\n        RegExp.$1,\n        RegExp.$1.length === 1 ? o[k] : ("00" + o[k]).substr(("" + o[k]).length)\n      );\n    }\n  }\n  return fmt;\n}\n')),(0,r.kt)("h2",{id:"\u4e0a\u4f20\u56fe\u7247"},"\u4e0a\u4f20\u56fe\u7247"),(0,r.kt)("p",null,"\u65b9\u6cd5\u6682\u672a\u652f\u6301\u591a\u9009"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"/**\n * @param {*} [{\n *   max = 1000,\n *   accept = 'image/jpg,image/jpeg,image/png,image/gif'\n * }={}]\n * @return {Promise<{file: Blob, base64: string}>} \n */\nexport async function uploadImg ({\n  multiple = false,\n  max = 1000,\n  accept = 'image/jpg,image/jpeg,image/png,image/gif'\n} = {}) {\n  return new Promise((resolve, reject) => {\n    const input = document.createElement('input')\n    input.setAttribute('style', 'opacty:0;height: 0;display: none;')\n    input.setAttribute('hidden', 'hidden')\n    input.setAttribute('type', 'file')\n    input.setAttribute('accept', 'image/jpg,image/jpeg,image/png,image/gif')\n    const oBody = document.getElementsByTagName('body')[0]\n    oBody.appendChild(input)\n    input.click()\n    input.onchange = function () {\n      const files = this.files\n      const file = files[0]\n      const maxsize = max * 1024\n      if (!/\\/(?:jpeg|jpg|png|gif|webp)/i.test(file.type)) {\n        oBody.removeChild(input)\n        return reject('\u8bf7\u9009\u62e9\u6b63\u786e\u7684\u56fe\u7247\u683c\u5f0f')\n      }\n      const reader = new FileReader()\n      reader.onload = function () {\n        // const baseStr = this.result\n        // \u9ed8\u8ba4\u5982\u679c\u56fe\u7247\u5927\u4e8e 1m\uff0c\u4e0d\u4f20\n        if (file.size >= maxsize) {\n          oBody.removeChild(input)\n          return reject('\u8bf7\u9009\u62e9\u5c0f\u4e8e' + max + 'kb\u7684\u6587\u4ef6')\n        }\n        compressFileToBase64(file).then(base64 => {\n          resolve({ file: dataURLtoBlobAsFile(base64, file.name || 'temp1.jpg'), base64: base64 })\n          oBody.removeChild(input) // \u4e0a\u4f20\u5b8c\u6210\u79fb\u9664input\n        })\n      }\n      reader.readAsDataURL(file)\n    }\n  })\n}\n\nexport function compressFileToBase64 (file, compressQuality = 0.8, maxLength = 1500) {\n  // \u56fe\u7247\u538b\u7f29\n  return new Promise(resolve => {\n    // \u901a\u8fc7fileReader\u5bf9\u8c61\uff0c\u8bfb\u53d6\u6d4f\u89c8\u5668\u4e2d\u5b58\u50a8\u7684\u6587\u4ef6\n    const fd = new FileReader()\n    // \u8bfb\u53d6\u6307\u5b9a\u7684Blob\u4e2d\u7684\u5185\u5bb9\uff0c\u6700\u540e\u5f97\u5230\u4e00\u4e2adata: URL\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\u4ee5\u8868\u793a\u6240\u8bfb\u53d6\u6587\u4ef6\u7684\u5185\u5bb9\n    fd.readAsDataURL(file)\n    fd.onloadend = e => {\n      const image = new Image()\n      image.onload = () => {\n        let width = image.width\n        let height = image.height\n        let rate = 1 // \u50cf\u7d20\u6bd4\u4f8b\n        if (Math.max(width, height) > maxLength) {\n          rate = maxLength / Math.max(width, height)\n        }\n        if (rate < 1 || file.size >= 2 * 1024 * 1024) {\n          // \u8d85\u51fa\u6700\u5927\u8fb9\u957f\u7b49\u6bd4\u4f8b\u7f29\u653e\n          width = width * rate\n          height = height * rate\n          const canvas = document.createElement('canvas')\n          const ctx = canvas.getContext('2d')\n          canvas.width = width\n          canvas.height = height\n          ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, width, height)\n          resolve(canvas.toDataURL('image/jpeg', compressQuality))\n          /* getFileExif(file).then(orientation => { // https://github.com/exif-js/exif-js\n            if (orientation !== '' && orientation !== 1 && orientation !== undefined && orientation !== 0) {\n              switch (orientation) {\n                case 6:// \u9700\u8981\u987a\u65f6\u9488\uff08\u5411\u5de6\uff0990\u5ea6\u65cb\u8f6c\n                  canvas.width = height\n                  canvas.height = width\n                  ctx.rotate(Math.PI / 2)\n                  ctx.drawImage(image, 0, -height, width, height)\n                  break\n                case 8:// \u9700\u8981\u9006\u65f6\u9488\uff08\u5411\u53f3\uff0990\u5ea6\u65cb\u8f6c\n                  canvas.width = height\n                  canvas.height = width\n                  ctx.rotate(-90 * Math.PI / 180)\n                  ctx.drawImage(image, -width, 0, width, height)\n                  break\n                case 3:// \u9700\u8981180\u5ea6\u65cb\u8f6c\n                  ctx.rotate(Math.PI)\n                  ctx.drawImage(image, -width, -height, width, height)\n                  break\n                default: ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, width, height)\n              }\n            } else {\n              ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, width, height)\n            }\n            resolve(canvas.toDataURL('image/jpeg', this.compressQuality))\n          }) */\n        } else {\n          resolve(e.target.result)\n        }\n      }\n      image.src = e.target.result\n    }\n  })\n}\n\nfunction dataURLtoBlobAsFile (dataurl, fileName) {\n  const arr = dataurl.split(',')\n  const mime = arr[0].match(/:(.*?);/)[1]\n  const bstr = atob(arr[1])\n  let n = bstr.length\n  const u8arr = new Uint8Array(n)\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n)\n  }\n  const file = new Blob([u8arr], { type: mime }) // \u5c06blob\u8f6c\u6362\u4e3afile\n  file.lastModifiedDate = new Date()\n  file.name = fileName\n  return file\n}\n\nexport function genUuid () {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    let r = Math.random() * 16 | 0,\n      v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n")),(0,r.kt)("h2",{id:"\u9632\u6296"},"\u9632\u6296"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function debounce(func) {\n    var timeout;\n    return function() {\n        var context = this;\n        var args = arguments;\n        clearTimeout(timeout)\n        timeout = setTimeout(function(){\n            func.apply(context, args);\n        }, 300)\n    }\n}\n")),(0,r.kt)("h2",{id:"\u4ece\u65e5\u671f\u4e2d\u83b7\u53d6\u65f6\u95f4"},"\u4ece\u65e5\u671f\u4e2d\u83b7\u53d6\u65f6\u95f4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"new Date().toTimeString().slice(0,8) // 12:20:40\n")),(0,r.kt)("h2",{id:"\u7ed9url\u6dfb\u52a0\u67e5\u8be2\u5b57\u7b26\u4e32"},"\u7ed9url\u6dfb\u52a0\u67e5\u8be2\u5b57\u7b26\u4e32"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"function addQuery (url, params) {\n  let separator = url.indexOf('?') !== -1 ? '&' : '?'\n  const queryStringParameter = Object.entries(params).reduce((result, target, index) => {\n    result += separator + target[0] + '=' + target[1]\n    separator = '&'\n    return result\n  }, '')\n  return url + queryStringParameter\n}\n")),(0,r.kt)("h2",{id:"\u5c0f\u7a0b\u5e8f\u6279\u91cf\u4e0a\u4f20\u56fe\u7247"},"\u5c0f\u7a0b\u5e8f\u6279\u91cf\u4e0a\u4f20\u56fe\u7247"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"/**\n * @param {*} wxfilelist chooseImg\u7684\u56fe\u7247\u4fe1\u606f\n */\nexport async function uploadWxImg (wxfilelist) {\n  return Promise.all(\n    wxfilelist.map((tempFiles, index) => {\n      wx.showLoading({ title: '\u56fe\u7247\u4e0a\u4f20\u4e2d', mask: true })\n      return new Promise(function (resolve, reject) {\n        wx.uploadFile({\n          url: '/upload/uploadImg',\n          filePath: tempFiles,\n          name: 'file',\n          success: function (res) {\n            if (res.statusCode === 200) {\n              if (JSON.parse(res.data).result === 200) {\n                resolve({\n                  url: JSON.parse(res.data).data.url\n                })\n                return false\n              } else {\n                return reject(JSON.parse(res.data).msg)\n              }\n            }\n            reject(new Error('failed to upload file'))\n          },\n          fail: function () {\n            reject(new Error('failed to upload file'))\n          }\n        })\n      })\n    })\n  )\n    .then(res => {\n      wx.hideLoading()\n      return res.map(el => el.url)\n    })\n    .catch(err => {\n      wx.hideLoading()\n      wx.showToast({ title: err || '\u4e0a\u4f20\u5931\u8d25\uff1a\u8bf7\u91cd\u65b0\u4e0a\u4f20', icon: 'none' })\n      return []\n    })\n}\n")),(0,r.kt)("h2",{id:"\u5ba2\u6237\u7aef\u83b7\u53d6\u5b9a\u4f4d"},"\u5ba2\u6237\u7aef\u83b7\u53d6\u5b9a\u4f4d"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// 1. \u4f7f\u7528\u641c\u72d0\u63d0\u4f9b\u63a5\u53e3\uff08IP\uff09\nGET: https://pv.sohu.com/cityjson?ie=utf-8\n\n// 2. \u6d4f\u89c8\u5668\u81ea\u5e26api\uff08\u9700\u7528\u6237\u68af\u5b50\uff09\nnavigator.geolocation.getCurrentPosition(function (position) {\n  console.dir(position)\n}, function (error) {\n  console.error(error)\n})\n")))}d.isMDXComponent=!0}}]);